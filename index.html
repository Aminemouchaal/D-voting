<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VoteChain - Decentralized Voting Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.2.9/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

    body {
      font-family: 'Inter', sans-serif;
    }

    .gradient-border {
      background: linear-gradient(45deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
      background-size: 300% 300%;
      animation: gradient 8s ease infinite;
    }

    @keyframes gradient {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    .glass {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .glass-strong {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(30px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .glow {
      box-shadow: 0 0 20px rgba(124, 58, 237, 0.5), 0 0 40px rgba(124, 58, 237, 0.3);
    }

    .pulse-slow {
      animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    .float {
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-20px);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .stats-card:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .candidate-card {
      transition: all 0.3s ease;
    }

    .candidate-card:hover {
      transform: translateX(5px);
    }

    .selected-candidate {
      background: rgba(124, 58, 237, 0.2);
      border: 2px solid #7c3aed !important;
      box-shadow: 0 0 30px rgba(124, 58, 237, 0.4);
    }

    .progress-bar {
      transition: width 1s ease-in-out;
    }
  </style>
</head>

<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen overflow-x-hidden">

  <!-- Animated Background -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div
      class="absolute w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob float"
      style="top: 10%; left: 10%;"></div>
    <div
      class="absolute w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob float"
      style="top: 50%; right: 10%; animation-delay: 2s;"></div>
    <div
      class="absolute w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob float"
      style="bottom: 10%; left: 50%; animation-delay: 4s;"></div>
  </div>

  <!-- Header -->
  <header class="relative z-10 glass-strong border-b border-white border-opacity-10">
    <div class="container mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-4">
          <div class="w-12 h-12 gradient-border rounded-xl flex items-center justify-center glow">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z">
              </path>
            </svg>
          </div>
          <div>
            <h1 class="text-3xl font-black text-white tracking-tight">VoteChain</h1>
            <p class="text-xs text-purple-300 font-medium">Transparent ‚Ä¢ Secure ‚Ä¢ Decentralized</p>
          </div>
        </div>

        <div class="flex items-center space-x-4">
          <div id="network-status" class="glass px-4 py-2 rounded-lg">
            <div class="flex items-center space-x-2">
              <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
              <span class="text-xs text-gray-300 font-medium">Sepolia Testnet</span>
            </div>
          </div>

          <div id="wallet-info"
            class="hidden glass-strong rounded-xl px-5 py-3 border-2 border-purple-500 border-opacity-30">
            <div class="flex items-center space-x-3">
              <div
                class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
              </div>
              <div>
                <p class="text-xs text-gray-400 font-medium">Wallet Connected</p>
                <p id="wallet-address" class="text-sm font-mono text-white font-semibold"></p>
                <p id="admin-badge" class="text-xs text-yellow-400 font-bold hidden">üëë ADMINISTRATOR</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="relative z-10 container mx-auto px-4 py-8">

    <!-- Connection Screen -->
    <div id="connect-screen" class="max-w-xl mx-auto text-center fade-in">
      <div class="glass-strong rounded-3xl p-12 border-2 border-white border-opacity-10 shadow-2xl">
        <div class="w-24 h-24 gradient-border rounded-2xl flex items-center justify-center mx-auto mb-8 glow float">
          <svg class="w-14 h-14 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z">
            </path>
          </svg>
        </div>
        <h2 class="text-4xl font-black text-white mb-4">Connect Wallet</h2>
        <p class="text-gray-300 text-lg mb-8">Secure your vote with blockchain technology</p>

        <button id="connect-button"
          class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 px-8 rounded-xl transition duration-300 transform hover:scale-105 shadow-lg hover:shadow-2xl text-lg">
          <div class="flex items-center justify-center space-x-3">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M22.5 12c0 5.799-4.701 10.5-10.5 10.5S1.5 17.799 1.5 12 6.201 1.5 12 1.5 22.5 6.201 22.5 12zm-6.347 3.427l-2.318-1.039a.75.75 0 01-.418-.67V9.281c0-.414.336-.75.75-.75h.583c.414 0 .75.336.75.75v3.817l1.736.777a.75.75 0 01.417.67v.133a.75.75 0 01-1 .708z" />
            </svg>
            <span>Connect MetaMask</span>
          </div>
        </button>

        <p id="connection-error" class="text-red-400 text-sm mt-6 hidden glass p-4 rounded-lg"></p>

        <div class="mt-8 flex items-center justify-center space-x-6 text-sm text-gray-400">
          <div class="flex items-center space-x-2">
            <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd"></path>
            </svg>
            <span>Secure</span>
          </div>
          <div class="flex items-center space-x-2">
            <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd"></path>
            </svg>
            <span>Anonymous</span>
          </div>
          <div class="flex items-center space-x-2">
            <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd"></path>
            </svg>
            <span>Transparent</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Interface -->
    <div id="main-interface" class="hidden fade-in">

      <!-- Admin Panel -->
      <div id="admin-panel" class="hidden mb-8">
        <div class="glass-strong rounded-3xl p-8 border-2 border-yellow-500 border-opacity-30 shadow-2xl">
          <div class="flex items-center justify-between mb-8">
            <div class="flex items-center space-x-4">
              <div
                class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl flex items-center justify-center shadow-lg">
                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4">
                  </path>
                </svg>
              </div>
              <div>
                <h2 class="text-3xl font-black text-white">Admin Control Center</h2>
                <p class="text-yellow-300 text-sm font-medium">Manage voters and control voting sessions</p>
              </div>
            </div>

            <div class="glass px-6 py-3 rounded-xl">
              <div class="text-center">
                <p class="text-xs text-gray-400 font-medium">VOTING STATUS</p>
                <p id="voting-status-admin" class="text-lg font-bold text-green-400">‚óè ACTIVE</p>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">

            <!-- Single Voter Registration -->
            <div class="glass rounded-2xl p-6 hover:scale-105 transition-transform duration-300">
              <div class="flex items-center space-x-3 mb-4">
                <div class="w-10 h-10 bg-blue-500 bg-opacity-20 rounded-lg flex items-center justify-center">
                  <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                  </svg>
                </div>
                <h3 class="text-white font-bold text-lg">Register Voter</h3>
              </div>
              <input type="text" id="voter-address" placeholder="Enter wallet address (0x...)"
                class="w-full glass border border-white border-opacity-20 rounded-xl px-4 py-3 text-white text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono">
              <button id="register-voter-btn"
                class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-4 rounded-xl transition transform hover:scale-105 shadow-lg">
                Register Voter
              </button>
            </div>

            <!-- Bulk Registration -->
            <div class="glass rounded-2xl p-6 hover:scale-105 transition-transform duration-300">
              <div class="flex items-center space-x-3 mb-4">
                <div class="w-10 h-10 bg-purple-500 bg-opacity-20 rounded-lg flex items-center justify-center">
                  <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z">
                    </path>
                  </svg>
                </div>
                <h3 class="text-white font-bold text-lg">Bulk Register</h3>
              </div>
              <textarea id="bulk-voters"
                placeholder="Paste addresses (one per line)&#10;0x123...&#10;0x456...&#10;0x789..." rows="2"
                class="w-full glass border border-white border-opacity-20 rounded-xl px-4 py-3 text-white text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-purple-500 font-mono resize-none"></textarea>
              <button id="bulk-register-btn"
                class="w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-4 rounded-xl transition transform hover:scale-105 shadow-lg">
                Register Multiple
              </button>
            </div>

            <!-- Voting Control -->
            <div class="glass rounded-2xl p-6 hover:scale-105 transition-transform duration-300">
              <div class="flex items-center space-x-3 mb-4">
                <div class="w-10 h-10 bg-green-500 bg-opacity-20 rounded-lg flex items-center justify-center">
                  <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <h3 class="text-white font-bold text-lg">Voting Control</h3>
              </div>
              <div class="space-y-3">
                <button id="start-voting-btn"
                  class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-4 rounded-xl transition transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                      clip-rule="evenodd"></path>
                  </svg>
                  <span>Start Voting</span>
                </button>
                <button id="end-voting-btn"
                  class="w-full bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white font-bold py-3 px-4 rounded-xl transition transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z"
                      clip-rule="evenodd"></path>
                  </svg>
                  <span>End Voting</span>
                </button>
              </div>
            </div>
          </div>

          <div id="admin-message" class="hidden">
            <div class="glass rounded-xl p-4 border-2">
              <p class="text-sm font-semibold"></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Eligibility Messages -->
      <div id="eligibility-check" class="max-w-3xl mx-auto mb-8 hidden fade-in">
        <div class="glass-strong rounded-3xl p-10 border-2 border-red-500 border-opacity-30 shadow-2xl">
          <div class="flex items-center space-x-4 mb-6">
            <div class="w-16 h-16 bg-red-500 bg-opacity-20 rounded-2xl flex items-center justify-center">
              <svg class="w-10 h-10 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                </path>
              </svg>
            </div>
            <div>
              <h2 class="text-3xl font-black text-white">Not Eligible to Vote</h2>
              <p class="text-gray-300 text-lg mt-2">Your wallet is not registered as an eligible voter</p>
            </div>
          </div>

          <div class="glass rounded-xl p-6 mb-6">
            <p class="text-sm text-gray-400 font-medium mb-2">Your Wallet Address:</p>
            <p class="text-white font-mono text-base break-all" id="ineligible-address"></p>
          </div>

          <p class="text-gray-300 text-center">Please contact the administrator to get registered for voting access.</p>
        </div>
      </div>

      <div id="voting-inactive" class="max-w-3xl mx-auto mb-8 hidden fade-in">
        <div class="glass-strong rounded-3xl p-10 border-2 border-orange-500 border-opacity-30 shadow-2xl">
          <div class="flex items-center space-x-4 mb-6">
            <div class="w-16 h-16 bg-orange-500 bg-opacity-20 rounded-2xl flex items-center justify-center pulse-slow">
              <svg class="w-10 h-10 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <div>
              <h2 class="text-3xl font-black text-white">Voting Not Active</h2>
              <p class="text-gray-300 text-lg mt-2">The voting session has not started yet or has ended</p>
            </div>
          </div>
          <p class="text-gray-300 text-center text-lg">Please wait for the administrator to start the voting session.
          </p>
        </div>
      </div>

      <!-- Statistics Dashboard -->
      <div id="stats-section" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 hidden">

        <div class="glass-strong rounded-2xl p-6 stats-card transition-all duration-300">
          <div class="flex items-center justify-between mb-4">
            <div
              class="w-14 h-14 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z">
                </path>
              </svg>
            </div>
          </div>
          <p class="text-gray-400 text-sm font-semibold mb-1">Total Voters</p>
          <p id="total-voters" class="text-5xl font-black text-white mb-2">0</p>
          <div class="flex items-center text-xs text-blue-400">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z"
                clip-rule="evenodd"></path>
            </svg>
            <span class="font-semibold">Registered members</span>
          </div>
        </div>

        <div class="glass-strong rounded-2xl p-6 stats-card transition-all duration-300">
          <div class="flex items-center justify-between mb-4">
            <div
              class="w-14 h-14 bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4">
                </path>
              </svg>
            </div>
          </div>
          <p class="text-gray-400 text-sm font-semibold mb-1">Total Votes</p>
          <p id="total-votes" class="text-5xl font-black text-white mb-2">0</p>
          <div class="flex items-center text-xs">
            <span class="text-purple-400 font-semibold">Votes cast so far</span>
          </div>
        </div>

        <div class="glass-strong rounded-2xl p-6 stats-card transition-all duration-300">
          <div class="flex items-center justify-between mb-4">
            <div
              class="w-14 h-14 bg-gradient-to-br from-pink-400 to-pink-600 rounded-xl flex items-center justify-center shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z">
                </path>
              </svg>
            </div>
          </div>
          <p class="text-gray-400 text-sm font-semibold mb-1">Leading</p>
          <p id="leading-candidate" class="text-3xl font-black text-white mb-2 truncate">-</p>
          <div class="flex items-center text-xs">
            <span class="text-pink-400 font-semibold">Current winner</span>
          </div>
        </div>

        <div class="glass-strong rounded-2xl p-6 stats-card transition-all duration-300">
          <div class="flex items-center justify-between mb-4">
            <div
              class="w-14 h-14 bg-gradient-to-br from-green-400 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                </path>
              </svg>
            </div>
          </div>
          <p class="text-gray-400 text-sm font-semibold mb-1">Turnout</p>
          <p id="turnout-percentage" class="text-5xl font-black text-white mb-2">0%</p>
          <div class="flex items-center text-xs">
            <span class="text-green-400 font-semibold" id="turnout-text">Participation rate</span>
          </div>
        </div>
      </div>

      <!-- Main Voting Section -->
      <div id="voting-section" class="grid grid-cols-1 lg:grid-cols-3 gap-8 hidden">

        <!-- Voting Panel -->
        <div class="lg:col-span-1 space-y-6">

          <!-- Cast Vote Card -->
          <div class="glass-strong rounded-3xl p-8 border border-white border-opacity-10 shadow-2xl">
            <div class="flex items-center space-x-3 mb-6">
              <div
                class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center">
                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div>
                <h2 class="text-2xl font-black text-white">Cast Your Vote</h2>
                <p class="text-gray-400 text-sm">Select a candidate below</p>
              </div>
            </div>

            <div id="candidates-list" class="space-y-3 mb-6">
              <!-- Candidates loaded dynamically -->
            </div>

            <button id="vote-button"
              class="w-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white font-black py-4 px-6 rounded-2xl transition duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none shadow-2xl text-lg">
              <span id="vote-button-text" class="flex items-center justify-center space-x-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Cast Vote</span>
              </span>
            </button>

            <div id="vote-status" class="mt-4 hidden fade-in">
              <div class="glass border-2 border-green-500 border-opacity-50 rounded-xl p-4 bg-green-500 bg-opacity-10">
                <p class="text-green-300 text-sm font-bold flex items-center">
                  <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                      clip-rule="evenodd"></path>
                  </svg>
                  Vote Successfully Cast!
                </p>
              </div>
            </div>

            <div id="vote-error" class="mt-4 hidden fade-in">
              <div class="glass border-2 border-red-500 border-opacity-50 rounded-xl p-4 bg-red-500 bg-opacity-10">
                <p class="text-red-300 text-sm font-bold flex items-center">
                  <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                      clip-rule="evenodd"></path>
                  </svg>
                  <span></span>
                </p>
              </div>
            </div>
          </div>

          <!-- Vote Status Card -->
          <div class="glass-strong rounded-2xl p-6 border border-yellow-500 border-opacity-30">
            <div class="flex items-center space-x-3 mb-4">
              <div class="w-10 h-10 bg-yellow-500 bg-opacity-20 rounded-lg flex items-center justify-center">
                <svg class="w-6 h-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z">
                  </path>
                </svg>
              </div>
              <h3 class="text-white font-bold text-lg">Your Vote Status</h3>
            </div>
            <div class="glass rounded-xl p-4 mb-3">
              <p class="text-yellow-300 font-bold text-lg" id="user-vote-status">Not yet voted</p>
            </div>
            <div class="flex items-start space-x-2 text-xs text-gray-400">
              <svg class="w-4 h-4 text-green-400 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z"
                  clip-rule="evenodd"></path>
              </svg>
              <p>Your vote is cryptographically secured and completely anonymous on the blockchain</p>
            </div>
          </div>
        </div>

        <!-- Results Section -->
        <div class="lg:col-span-2 space-y-6">

          <!-- Live Results -->
          <div class="glass-strong rounded-3xl p-8 border border-white border-opacity-10 shadow-2xl">
            <div class="flex items-center justify-between mb-8">
              <div class="flex items-center space-x-3">
                <div
                  class="w-12 h-12 bg-gradient-to-br from-green-400 to-emerald-600 rounded-xl flex items-center justify-center pulse-slow">
                  <div class="w-3 h-3 bg-white rounded-full"></div>
                </div>
                <div>
                  <h2 class="text-3xl font-black text-white">Live Results</h2>
                  <p class="text-gray-400 text-sm">Updates every 5 seconds</p>
                </div>
              </div>

              <div class="glass px-4 py-2 rounded-xl">
                <p class="text-xs text-gray-400 font-medium">Last Updated</p>
                <p id="last-update" class="text-sm text-white font-semibold">Just now</p>
              </div>
            </div>

            <div class="space-y-4" id="results-container">
              <!-- Results loaded dynamically -->
            </div>
          </div>

          <!-- Charts Section -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- Pie Chart -->
            <div class="glass-strong rounded-2xl p-6 border border-white border-opacity-10 shadow-xl">
              <h3 class="text-xl font-bold text-white mb-6 flex items-center">
                <svg class="w-6 h-6 mr-2 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path>
                </svg>
                Vote Distribution
              </h3>
              <div class="bg-white bg-opacity-5 rounded-xl p-4">
                <canvas id="voteChart"></canvas>
              </div>
            </div>

            <!-- Bar Chart -->
            <div class="glass-strong rounded-2xl p-6 border border-white border-opacity-10 shadow-xl">
              <h3 class="text-xl font-bold text-white mb-6 flex items-center">
                <svg class="w-6 h-6 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                  </path>
                </svg>
                Vote Comparison
              </h3>
              <div class="bg-white bg-opacity-5 rounded-xl p-4">
                <canvas id="barChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="relative z-10 mt-16 glass-strong border-t border-white border-opacity-10 py-8">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
        <div class="text-center md:text-left">
          <p class="text-white font-bold text-lg">VoteChain Platform</p>
          <p class="text-gray-400 text-sm">Powered by Ethereum Blockchain</p>
        </div>

        <div class="flex items-center space-x-6 text-sm text-gray-400">
          <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
            <span>Blockchain Connected</span>
          </div>
          <div class="flex items-center space-x-2">
            <svg class="w-4 h-4 text-blue-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd"></path>
            </svg>
            <span>Secure & Anonymous</span>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <script>
    let web3, contract, accounts, isAdmin = false, isRegistered = false, hasVoted = false;
    let votingActive = false, chart, barChart, selectedCandidate = null, candidateCount = 0;

    const contractAddress = '0xAEabCDEfD52D0B2d73415bfec040990d55AC14BF';
    const abi = [
        {
          "anonymous": false,
          "inputs": [
            {
              "indexed": false,
              "internalType": "string",
              "name": "candidate",
              "type": "string"
            }
          ],
          "name": "VoteCast",
          "type": "event"
        },
        {
          "anonymous": false,
          "inputs": [
            {
              "indexed": false,
              "internalType": "address",
              "name": "voter",
              "type": "address"
            }
          ],
          "name": "VoterRegistered",
          "type": "event"
        },
        {
          "anonymous": false,
          "inputs": [],
          "name": "VotingEnded",
          "type": "event"
        },
        {
          "anonymous": false,
          "inputs": [],
          "name": "VotingStarted",
          "type": "event"
        },
        {
          "inputs": [],
          "name": "endVoting",
          "outputs": [],
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "address[]",
              "name": "voters",
              "type": "address[]"
            }
          ],
          "name": "registerMultipleVoters",
          "outputs": [],
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "address",
              "name": "voter",
              "type": "address"
            }
          ],
          "name": "registerVoter",
          "outputs": [],
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "inputs": [],
          "name": "startVoting",
          "outputs": [],
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "uint256",
              "name": "candidateIndex",
              "type": "uint256"
            }
          ],
          "name": "vote",
          "outputs": [],
          "stateMutability": "nonpayable",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "string[]",
              "name": "candidateNames",
              "type": "string[]"
            }
          ],
          "stateMutability": "nonpayable",
          "type": "constructor"
        },
        {
          "inputs": [],
          "name": "admin",
          "outputs": [
            {
              "internalType": "address",
              "name": "",
              "type": "address"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "uint256",
              "name": "",
              "type": "uint256"
            }
          ],
          "name": "candidates",
          "outputs": [
            {
              "internalType": "string",
              "name": "name",
              "type": "string"
            },
            {
              "internalType": "uint256",
              "name": "voteCount",
              "type": "uint256"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "uint256",
              "name": "index",
              "type": "uint256"
            }
          ],
          "name": "getCandidate",
          "outputs": [
            {
              "internalType": "string",
              "name": "",
              "type": "string"
            },
            {
              "internalType": "uint256",
              "name": "",
              "type": "uint256"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [],
          "name": "getCandidateCount",
          "outputs": [
            {
              "internalType": "uint256",
              "name": "",
              "type": "uint256"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [],
          "name": "getTotalVotes",
          "outputs": [
            {
              "internalType": "uint256",
              "name": "",
              "type": "uint256"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "address",
              "name": "voter",
              "type": "address"
            }
          ],
          "name": "hasUserVoted",
          "outputs": [
            {
              "internalType": "bool",
              "name": "",
              "type": "bool"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "address",
              "name": "",
              "type": "address"
            }
          ],
          "name": "hasVoted",
          "outputs": [
            {
              "internalType": "bool",
              "name": "",
              "type": "bool"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "address",
              "name": "voter",
              "type": "address"
            }
          ],
          "name": "isRegistered",
          "outputs": [
            {
              "internalType": "bool",
              "name": "",
              "type": "bool"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [
            {
              "internalType": "address",
              "name": "",
              "type": "address"
            }
          ],
          "name": "registeredVoters",
          "outputs": [
            {
              "internalType": "bool",
              "name": "",
              "type": "bool"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        },
        {
          "inputs": [],
          "name": "votingActive",
          "outputs": [
            {
              "internalType": "bool",
              "name": "",
              "type": "bool"
            }
          ],
          "stateMutability": "view",
          "type": "function"
        }
      ]; // Paste ABI here

    const colors = [
      { bg: 'from-blue-400 to-blue-600', bar: 'rgba(96, 165, 250, 0.8)', border: 'rgba(96, 165, 250, 1)' },
      { bg: 'from-purple-400 to-purple-600', bar: 'rgba(192, 132, 252, 0.8)', border: 'rgba(192, 132, 252, 1)' },
      { bg: 'from-pink-400 to-pink-600', bar: 'rgba(244, 114, 182, 0.8)', border: 'rgba(244, 114, 182, 1)' },
      { bg: 'from-yellow-400 to-yellow-600', bar: 'rgba(251, 191, 36, 0.8)', border: 'rgba(251, 191, 36, 1)' },
      { bg: 'from-green-400 to-green-600', bar: 'rgba(34, 197, 94, 0.8)', border: 'rgba(34, 197, 94, 1)' }
    ];

    function initCharts() {
      const ctx = document.getElementById('voteChart').getContext('2d');
      chart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: [],
          datasets: [{
            data: [],
            backgroundColor: colors.map(c => c.bar),
            borderColor: colors.map(c => c.border),
            borderWidth: 3
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                color: 'white',
                padding: 15,
                font: { size: 13, weight: '600' }
              }
            }
          }
        }
      });

      const barCtx = document.getElementById('barChart').getContext('2d');
      barChart = new Chart(barCtx, {
        type: 'bar',
        data: {
          labels: [],
          datasets: [{
            label: 'Votes',
            data: [],
            backgroundColor: colors.map(c => c.bar),
            borderColor: colors.map(c => c.border),
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { color: 'white', font: { weight: '600' } },
              grid: { color: 'rgba(255, 255, 255, 0.1)' }
            },
            x: {
              ticks: { color: 'white', font: { weight: '600' } },
              grid: { display: false }
            }
          }
        }
      });
    }

    document.getElementById('connect-button').addEventListener('click', async () => {
      if (typeof window.ethereum === 'undefined') {
        showConnectionError('MetaMask is not installed! Please install MetaMask extension.');
        return;
      }

      try {
        web3 = new Web3(window.ethereum);
        accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        contract = new web3.eth.Contract(abi, contractAddress);

        document.getElementById('wallet-address').textContent =
          accounts[0].substring(0, 6) + '...' + accounts[0].substring(38);
        document.getElementById('wallet-info').classList.remove('hidden');
        document.getElementById('connect-screen').classList.add('hidden');
        document.getElementById('main-interface').classList.remove('hidden');

        await checkUserRole();
        initCharts();
        await loadCandidates();
        await updateInterface();

        setInterval(updateInterface, 5000);
        setInterval(updateLastUpdateTime, 1000);
      } catch (error) {
        showConnectionError('Failed to connect wallet: ' + error.message);
      }
    });

    function showConnectionError(message) {
      const errorEl = document.getElementById('connection-error');
      errorEl.textContent = message;
      errorEl.classList.remove('hidden');
    }

    async function checkUserRole() {
      try {
        const admin = await contract.methods.admin().call();
        isAdmin = admin.toLowerCase() === accounts[0].toLowerCase();

        if (isAdmin) {
          document.getElementById('admin-badge').classList.remove('hidden');
          document.getElementById('admin-panel').classList.remove('hidden');
        }

        isRegistered = await contract.methods.isRegistered(accounts[0]).call();
        hasVoted = await contract.methods.hasUserVoted(accounts[0]).call();
        votingActive = await contract.methods.votingActive().call();
      } catch (error) {
        console.error('Error checking user role:', error);
      }
    }

    async function loadCandidates() {
      try {
        candidateCount = await contract.methods.getCandidateCount().call();
        const candidatesList = document.getElementById('candidates-list');
        candidatesList.innerHTML = '';

        for (let i = 0; i < candidateCount; i++) {
          const candidate = await contract.methods.getCandidate(i).call();
          const color = colors[i % colors.length];

          const div = document.createElement('div');
          div.className = 'candidate-card glass border-2 border-transparent rounded-2xl p-4 cursor-pointer transition-all duration-300 hover:border-purple-500';
          div.setAttribute('data-index', i);
          div.innerHTML = `
            <div class="flex items-center space-x-4">
              <div class="w-14 h-14 bg-gradient-to-br ${color.bg} rounded-xl flex items-center justify-center shadow-lg">
                <span class="text-white font-black text-2xl">${candidate[0].charAt(0)}</span>
              </div>
              <div class="flex-1">
                <h4 class="text-white font-bold text-lg">${candidate[0]}</h4>
                <p class="text-gray-400 text-sm">Click to select</p>
              </div>
              <svg class="w-6 h-6 text-gray-600 check-icon hidden" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
              </svg>
            </div>
          `;

          div.addEventListener('click', () => {
            document.querySelectorAll('.candidate-card').forEach(el => {
              el.classList.remove('selected-candidate', 'border-purple-500');
              el.querySelector('.check-icon').classList.add('hidden');
            });
            div.classList.add('selected-candidate', 'border-purple-500');
            div.querySelector('.check-icon').classList.remove('hidden');
            div.querySelector('.check-icon').classList.add('text-green-400');
            selectedCandidate = i;
          });

          candidatesList.appendChild(div);
        }
      } catch (error) {
        console.error('Error loading candidates:', error);
      }
    }

    async function updateInterface() {
      try {
        votingActive = await contract.methods.votingActive().call();
        isRegistered = await contract.methods.isRegistered(accounts[0]).call();
        hasVoted = await contract.methods.hasUserVoted(accounts[0]).call();

        const statusText = votingActive ? '‚óè ACTIVE' : '‚óè INACTIVE';
        const statusClass = votingActive ? 'text-green-400' : 'text-red-400';
        document.getElementById('voting-status-admin').textContent = statusText;
        document.getElementById('voting-status-admin').className = `text-lg font-bold ${statusClass}`;

        if (!isRegistered && !isAdmin) {
          document.getElementById('eligibility-check').classList.remove('hidden');
          document.getElementById('ineligible-address').textContent = accounts[0];
          document.getElementById('voting-section').classList.add('hidden');
          document.getElementById('stats-section').classList.add('hidden');
          return;
        }

        if (!votingActive) {
          document.getElementById('voting-inactive').classList.remove('hidden');
          document.getElementById('voting-section').classList.add('hidden');
        } else {
          document.getElementById('voting-inactive').classList.add('hidden');
          document.getElementById('voting-section').classList.remove('hidden');
        }

        document.getElementById('eligibility-check').classList.add('hidden');
        document.getElementById('stats-section').classList.remove('hidden');

        if (hasVoted) {
          document.getElementById('user-vote-status').textContent = '‚úì Vote Recorded';
          document.getElementById('vote-button').disabled = true;
        }

        await updateResults();
      } catch (error) {
        console.error('Error updating interface:', error);
      }
    }

    async function updateResults() {
      try {
        let totalVotes = 0;
        const candidates = [];
        const votes = [];
        const labels = [];

        for (let i = 0; i < candidateCount; i++) {
          const candidate = await contract.methods.getCandidate(i).call();
          const voteCount = parseInt(candidate[1]);
          candidates.push({ name: candidate[0], votes: voteCount });
          votes.push(voteCount);
          labels.push(candidate[0]);
          totalVotes += voteCount;
        }

        document.getElementById('total-votes').textContent = totalVotes;
        document.getElementById('total-voters').textContent = totalVotes;

        const turnout = totalVotes > 0 ? ((totalVotes / candidateCount) * 100).toFixed(1) : 0;
        document.getElementById('turnout-percentage').textContent = turnout + '%';

        const leader = candidates.reduce((max, c) => c.votes > max.votes ? c : max, candidates[0]);
        document.getElementById('leading-candidate').textContent = leader.votes > 0 ? leader.name : '-';

        const resultsContainer = document.getElementById('results-container');
        resultsContainer.innerHTML = '';

        candidates.forEach((candidate, index) => {
          const percentage = totalVotes > 0 ? ((candidate.votes / totalVotes) * 100).toFixed(1) : 0;
          const color = colors[index % colors.length];

          const div = document.createElement('div');
          div.className = 'glass rounded-2xl p-6 hover:scale-102 transition-transform duration-300';
          div.innerHTML = `
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center space-x-4">
                <div class="w-16 h-16 bg-gradient-to-br ${color.bg} rounded-2xl flex items-center justify-center shadow-xl">
                  <span class="text-white font-black text-2xl">${candidate.name.charAt(0)}</span>
                </div>
                <div>
                  <h3 class="text-white font-bold text-2xl">${candidate.name}</h3>
                  <p class="text-gray-400 text-sm font-semibold">${candidate.votes} votes</p>
                </div>
              </div>
              <div class="text-right">
                <p class="text-5xl font-black text-white">${percentage}%</p>
              </div>
            </div>
            <div class="w-full bg-gray-800 bg-opacity-50 rounded-full h-4 overflow-hidden">
              <div class="progress-bar bg-gradient-to-r ${color.bg} h-4 rounded-full shadow-lg" style="width: ${percentage}%"></div>
            </div>
          `;
          resultsContainer.appendChild(div);
        });

        if (chart) {
          chart.data.labels = labels;
          chart.data.datasets[0].data = votes;
          chart.update();
        }

        if (barChart) {
          barChart.data.labels = labels;
          barChart.data.datasets[0].data = votes;
          barChart.update();
        }
      } catch (error) {
        console.error('Error updating results:', error);
      }
    }

    let lastUpdateSeconds = 0;
    function updateLastUpdateTime() {
      lastUpdateSeconds++;
      const text = lastUpdateSeconds < 60 ? `${lastUpdateSeconds}s ago` : 'Just now';
      document.getElementById('last-update').textContent = text;
      if (lastUpdateSeconds >= 5) lastUpdateSeconds = 0;
    }

    document.getElementById('vote-button').addEventListener('click', async () => {
      if (selectedCandidate === null) {
        showError('Please select a candidate first');
        return;
      }

      const voteButton = document.getElementById('vote-button');
      const voteButtonText = document.getElementById('vote-button-text');

      try {
        voteButton.disabled = true;
        voteButtonText.innerHTML = `
          <svg class="animate-spin w-6 h-6" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span>Processing...</span>
        `;

        await contract.methods.vote(selectedCandidate).send({ from: accounts[0] });

        hasVoted = true;
        document.getElementById('user-vote-status').textContent = '‚úì Vote Recorded';
        voteButtonText.innerHTML = `
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          <span>Vote Cast Successfully</span>
        `;
        document.getElementById('vote-status').classList.remove('hidden');
        document.getElementById('vote-error').classList.add('hidden');

        setTimeout(() => {
          document.getElementById('vote-status').classList.add('hidden');
        }, 5000);

        await updateResults();
      } catch (error) {
        voteButton.disabled = false;
        voteButtonText.innerHTML = `
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span>Cast Vote</span>
        `;
        showError(error.message);
      }
    });

    // Admin Functions
    document.getElementById('register-voter-btn').addEventListener('click', async () => {
      const address = document.getElementById('voter-address').value.trim();
      if (!web3.utils.isAddress(address)) {
        showAdminMessage('Invalid Ethereum address format', false);
        return;
      }

      try {
        await contract.methods.registerVoter(address).send({ from: accounts[0] });
        showAdminMessage('‚úì Voter registered successfully!', true);
        document.getElementById('voter-address').value = '';
      } catch (error) {
        showAdminMessage('Error: ' + error.message, false);
      }
    });

    document.getElementById('bulk-register-btn').addEventListener('click', async () => {
      const addresses = document.getElementById('bulk-voters').value
        .split('\n')
        .map(a => a.trim())
        .filter(a => a);

      const validAddresses = addresses.filter(addr => web3.utils.isAddress(addr));
      if (validAddresses.length === 0) {
        showAdminMessage('No valid addresses found. Please check the format.', false);
        return;
      }

      if (addresses.length !== validAddresses.length) {
        showAdminMessage(`Warning: ${addresses.length - validAddresses.length} invalid addresses skipped`, false);
      }

      try {
        await contract.methods.registerMultipleVoters(validAddresses).send({ from: accounts[0] });
        showAdminMessage(`‚úì Successfully registered ${validAddresses.length} voters!`, true);
        document.getElementById('bulk-voters').value = '';
      } catch (error) {
        showAdminMessage('Error: ' + error.message, false);
      }
    });

    document.getElementById('start-voting-btn').addEventListener('click', async () => {
      try {
        await contract.methods.startVoting().send({ from: accounts[0] });
        showAdminMessage('‚úì Voting session started successfully!', true);
        await updateInterface();
      } catch (error) {
        showAdminMessage('Error: ' + error.message, false);
      }
    });

    document.getElementById('end-voting-btn').addEventListener('click', async () => {
      if (!confirm('Are you sure you want to end the voting session? This action cannot be undone.')) {
        return;
      }

      try {
        await contract.methods.endVoting().send({ from: accounts[0] });
        showAdminMessage('‚úì Voting session ended successfully!', true);
        await updateInterface();
      } catch (error) {
        showAdminMessage('Error: ' + error.message, false);
      }
    });

    function showError(message) {
      const errorDiv = document.getElementById('vote-error');
      errorDiv.querySelector('span').textContent = message;
      errorDiv.classList.remove('hidden');
      setTimeout(() => errorDiv.classList.add('hidden'), 5000);
    }

    function showAdminMessage(message, success) {
      const msgDiv = document.getElementById('admin-message');
      const p = msgDiv.querySelector('p');
      const container = msgDiv.querySelector('div');

      p.textContent = message;
      msgDiv.classList.remove('hidden');

      if (success) {
        container.className = 'glass rounded-xl p-4 border-2 border-green-500 border-opacity-50 bg-green-500 bg-opacity-10';
        p.className = 'text-green-300 text-sm font-semibold';
      } else {
        container.className = 'glass rounded-xl p-4 border-2 border-red-500 border-opacity-50 bg-red-500 bg-opacity-10';
        p.className = 'text-red-300 text-sm font-semibold';
      }

      setTimeout(() => msgDiv.classList.add('hidden'), 5000);
    }

    // Handle account changes
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', function (accounts) {
        if (accounts.length === 0) {
          location.reload();
        } else {
          location.reload();
        }
      });

      window.ethereum.on('chainChanged', function (chainId) {
        location.reload();
      });
    }
  </script>
</body>


</html>
